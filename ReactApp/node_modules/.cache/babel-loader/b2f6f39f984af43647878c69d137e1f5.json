{"ast":null,"code":"var _jsxFileName = \"C:\\\\Proyectos\\\\NosPremiamos\\\\ReactApp\\\\src\\\\pages\\\\terminales\\\\saldo.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from 'react';\nimport { Button, Form } from '@themesberg/react-bootstrap';\nimport toast from 'react-hot-toast';\nimport { DateTime } from 'luxon';\nimport * as XLSX from 'xlsx/xlsx.mjs';\nimport { TranslatableText } from '../../components/translations';\nimport { useGetQuery, useLiquidarCuentaCorrienteMutation } from '../../redux/apis/terminales';\nimport { translationsGroupNames } from '../../utils/translationsGroupNames';\nimport PermissionChecker from '../../components/permissionChecker';\nimport { permissionsKeys } from '../../utils/permissionsKeys';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default _s(_ref => {\n  _s();\n\n  let {\n    id = 0\n  } = _ref;\n  const {\n    data: terminal = {},\n    isError: isTerminalGetError,\n    error: terminalGetError\n  } = useGetQuery(id, {\n    skip: !!!id\n  });\n  const [liquidar, {\n    isSuccess: isLiquidacionSuccess,\n    data: liquidacionData,\n    isError: isLiquidacionError,\n    error: liquidacionError\n  }] = useLiquidarCuentaCorrienteMutation();\n  const permiteDescargarReporte = PermissionChecker(permissionsKeys.TERMINAL_LIQUIDACION_DESCARGAR);\n\n  const submitHandler = event => {\n    event.preventDefault();\n    liquidar(terminal.saldoCtaCte);\n  };\n\n  useEffect(() => {\n    if (isTerminalGetError) {\n      const errors = Object.values(terminalGetError.data);\n      toast.error(errors);\n    }\n  }, [isTerminalGetError, terminalGetError]);\n  useEffect(() => {\n    if (isLiquidacionSuccess) {\n      toast.success(liquidacionData.message);\n\n      if (permiteDescargarReporte) {\n        const date = DateTime.now().toFormat('yyyyLLddHHmmss');\n        const header = ['Número de ticket liquidado', 'Representante', 'Patente', 'Importe cobrado'];\n        const data = liquidacionData.cupos.map(cupo => [cupo.terminalTalonarioTicket.numero, `${cupo.representante.firstName} ${cupo.representante.lastName}`, cupo.representantePatente.patente, 0]);\n        const workbook = XLSX.utils.book_new();\n        const sheet = XLSX.utils.aoa_to_sheet([header, ...data, ['Total', '', '', {\n          t: 'n',\n          v: 3,\n          f: `SUM(D2:D${data.length + 1})`\n        }]]);\n        XLSX.utils.book_append_sheet(workbook, sheet, 'liquidacion');\n        XLSX.writeFile(workbook, `${terminal.nombre}Liquidacion${date}.xlsx`);\n      }\n    }\n  }, [isLiquidacionSuccess, liquidacionData]);\n  useEffect(() => {\n    if (isLiquidacionError) {\n      const errors = [].concat(...Object.values(liquidacionError.data)).join('\\n');\n      toast.error(errors);\n    }\n  }, [isLiquidacionError, liquidacionError]);\n  return /*#__PURE__*/_jsxDEV(Form, {\n    onSubmit: submitHandler,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-block mb-4 mb-md-0\",\n        children: /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: /*#__PURE__*/_jsxDEV(TranslatableText, {\n            group: translationsGroupNames.Terminales,\n            entry: \"LiquidarSaldoCuentaCorriente\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-block mb-4 mb-md-0\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          type: \"submit\",\n          children: /*#__PURE__*/_jsxDEV(TranslatableText, {\n            group: translationsGroupNames.Generic,\n            entry: \"Liquidar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n      className: \"card-subtitle mb-2 text-muted\",\n      children: /*#__PURE__*/_jsxDEV(TranslatableText, {\n        group: translationsGroupNames.Terminales,\n        entry: \"SaldoDisponibleCuentaCorriente\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex\",\n      children: /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [\"$\", terminal.saldoCtaCte || 0]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n}, \"mqcPz9bLdfuLrw+8Wp73KlmhBDY=\", false, function () {\n  return [useGetQuery, useLiquidarCuentaCorrienteMutation];\n});","map":{"version":3,"names":["React","useEffect","Button","Form","toast","DateTime","XLSX","TranslatableText","useGetQuery","useLiquidarCuentaCorrienteMutation","translationsGroupNames","PermissionChecker","permissionsKeys","id","data","terminal","isError","isTerminalGetError","error","terminalGetError","skip","liquidar","isSuccess","isLiquidacionSuccess","liquidacionData","isLiquidacionError","liquidacionError","permiteDescargarReporte","TERMINAL_LIQUIDACION_DESCARGAR","submitHandler","event","preventDefault","saldoCtaCte","errors","Object","values","success","message","date","now","toFormat","header","cupos","map","cupo","terminalTalonarioTicket","numero","representante","firstName","lastName","representantePatente","patente","workbook","utils","book_new","sheet","aoa_to_sheet","t","v","f","length","book_append_sheet","writeFile","nombre","concat","join","Terminales","Generic"],"sources":["C:/Proyectos/NosPremiamos/ReactApp/src/pages/terminales/saldo.jsx"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { Button, Form } from '@themesberg/react-bootstrap';\r\nimport toast from 'react-hot-toast';\r\nimport { DateTime } from 'luxon';\r\nimport * as XLSX from 'xlsx/xlsx.mjs';\r\n\r\nimport { TranslatableText } from '../../components/translations';\r\nimport { useGetQuery, useLiquidarCuentaCorrienteMutation } from '../../redux/apis/terminales';\r\nimport { translationsGroupNames } from '../../utils/translationsGroupNames';\r\nimport PermissionChecker from '../../components/permissionChecker';\r\nimport { permissionsKeys } from '../../utils/permissionsKeys';\r\n\r\nexport default ({ id = 0 }) => {\r\n  const { data: terminal = {}, isError: isTerminalGetError, error: terminalGetError } = useGetQuery(id, { skip: !!!id });\r\n  const [liquidar, { isSuccess: isLiquidacionSuccess, data: liquidacionData, isError: isLiquidacionError, error: liquidacionError }] = useLiquidarCuentaCorrienteMutation();\r\n  const permiteDescargarReporte = PermissionChecker(permissionsKeys.TERMINAL_LIQUIDACION_DESCARGAR);\r\n\r\n  const submitHandler = (event) => {\r\n    event.preventDefault();\r\n    liquidar(terminal.saldoCtaCte);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isTerminalGetError) {\r\n      const errors = Object.values(terminalGetError.data);\r\n      toast.error(errors);\r\n    }\r\n  }, [isTerminalGetError, terminalGetError]);\r\n\r\n  useEffect(() => {\r\n    if (isLiquidacionSuccess) {\r\n      toast.success(liquidacionData.message);\r\n\r\n      if (permiteDescargarReporte) {\r\n        const date = DateTime.now().toFormat('yyyyLLddHHmmss');\r\n        const header = ['Número de ticket liquidado', 'Representante', 'Patente', 'Importe cobrado'];\r\n        const data = liquidacionData.cupos.map((cupo) => [\r\n          cupo.terminalTalonarioTicket.numero,\r\n          `${cupo.representante.firstName} ${cupo.representante.lastName}`,\r\n          cupo.representantePatente.patente,\r\n          0\r\n        ]);\r\n        const workbook = XLSX.utils.book_new();\r\n        const sheet = XLSX.utils.aoa_to_sheet([header, ...data, ['Total', '', '', { t: 'n', v: 3, f: `SUM(D2:D${data.length + 1})` }]]);\r\n        XLSX.utils.book_append_sheet(workbook, sheet, 'liquidacion');\r\n        XLSX.writeFile(workbook, `${terminal.nombre}Liquidacion${date}.xlsx`);\r\n      }\r\n    }\r\n  }, [isLiquidacionSuccess, liquidacionData]);\r\n\r\n  useEffect(() => {\r\n    if (isLiquidacionError) {\r\n      const errors = [].concat(...Object.values(liquidacionError.data)).join('\\n');\r\n      toast.error(errors);\r\n    }\r\n  }, [isLiquidacionError, liquidacionError]);\r\n\r\n  return (\r\n    <Form onSubmit={submitHandler}>\r\n      <div className=\"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-4\">\r\n        <div className=\"d-block mb-4 mb-md-0\">\r\n          <h4>\r\n            <TranslatableText group={translationsGroupNames.Terminales} entry=\"LiquidarSaldoCuentaCorriente\" />\r\n          </h4>\r\n        </div>\r\n        <div className=\"d-block mb-4 mb-md-0\">\r\n          <Button type=\"submit\">\r\n            <TranslatableText group={translationsGroupNames.Generic} entry=\"Liquidar\" />\r\n          </Button>\r\n        </div>\r\n      </div>\r\n      <h6 className=\"card-subtitle mb-2 text-muted\">\r\n        <TranslatableText group={translationsGroupNames.Terminales} entry=\"SaldoDisponibleCuentaCorriente\" />\r\n      </h6>\r\n      <div className=\"d-flex\">\r\n        <h3>${terminal.saldoCtaCte || 0}</h3>\r\n      </div>\r\n    </Form>\r\n  );\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}